// Autogenerated from development/origins/test_origin_printer.i

package ideal.development.origins;

import ideal.library.elements.*;
import ideal.library.texts.*;
import ideal.library.channels.*;
import ideal.library.resources.*;
import ideal.library.patterns.*;
import ideal.runtime.elements.*;
import ideal.runtime.texts.*;
import ideal.runtime.patterns.*;
import ideal.runtime.logs.*;
import ideal.development.elements.*;
import ideal.development.names.*;
import ideal.machine.channels.string_writer;

public class test_origin_printer {
  public void run_all_tests() {
    ideal.machine.elements.runtime_util.start_test("test_origin_printer.test_show_origins");
    test_show_origins();
    ideal.machine.elements.runtime_util.end_test();
  }
  public void show_origin_helper(final string input, final int begin, final int end, final string output) {
    final source_content source = new source_content(simple_name.make(new base_string("foo")), input);
    final text_origin the_origin = (text_origin) source.make_origin(begin, end);
    final string_writer the_writer = new string_writer();
    final plain_formatter out = new plain_formatter(the_writer);
    out.write(origin_printer.render_text_origin(the_origin, null, null));
    assert ideal.machine.elements.runtime_util.values_equal(the_writer.elements(), output);
  }
  public void test_show_origins() {
    final string input = new base_string("hello\nworld\n");
    this.show_origin_helper(input, 1, 2, new base_string("hello\n ^\n"));
    this.show_origin_helper(input, 0, 5, new base_string("hello\n^^^^^\n"));
    this.show_origin_helper(input, 2, 6, new base_string("hello \n  ^^^^\n"));
    this.show_origin_helper(input, 0, 10, new base_string("hello \n^^^^^^\n"));
    this.show_origin_helper(input, 8, 10, new base_string("world\n  ^^\n"));
    this.show_origin_helper(input, 7, 7, new base_string("world\n ^\n"));
    this.show_origin_helper(input, 5, 5, new base_string("hello \n     ^\n"));
    this.show_origin_helper(input, 12, 12, new base_string("world \n     ^\n"));
  }
  public test_origin_printer() { }
}
