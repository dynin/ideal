// Autogenerated from runtime/elements/test_runtime_util.i

package ideal.runtime.elements;

import ideal.library.elements.*;
import ideal.machine.elements.runtime_util;

public class test_runtime_util {
  private static class test1 implements data, equality_comparable {
    public test1(final int i, final string s) {
      this.i = i;
      this.s = s;
    }
    public final int i;
    public final string s;
  }
  private final test_runtime_util.test1 v1;
  private final test_runtime_util.test1 v2;
  private final test_runtime_util.test1 v3;
  private final test_runtime_util.test1 v4;
  public test_runtime_util() {
    this.v1 = new test_runtime_util.test1(98, new base_string("asdf"));
    this.v2 = new test_runtime_util.test1(98, new base_string("asdf"));
    this.v3 = new test_runtime_util.test1(99, new base_string("asdf"));
    this.v4 = new test_runtime_util.test1(98, new base_string("asdfghj"));
  }
  public void test_class_name() {
    assert runtime_util.values_equal(runtime_util.short_class_name(this), new base_string("test_runtime_util"));
    assert runtime_util.values_equal(runtime_util.short_class_name(new base_string("Hi")), new base_string("base_string"));
  }
  public void test_hash_code() {
    final int hash1 = runtime_util.compute_hash_code(this.v1);
    final int hash2 = runtime_util.compute_hash_code(this.v2);
    final int hash3 = runtime_util.compute_hash_code(this.v3);
    final int hash4 = runtime_util.compute_hash_code(this.v4);
    assert hash1 == hash2;
    assert hash1 != hash3;
    assert hash1 != hash4;
    assert hash3 != hash4;
  }
  public void test_simple_equals() {
    assert runtime_util.values_equal(this.v1, this.v2);
    assert !runtime_util.values_equal(this.v1, this.v3);
    assert !runtime_util.values_equal(this.v1, this.v4);
    assert !runtime_util.values_equal(this.v4, this.v3);
    assert !runtime_util.values_equal(this.v1, this.v3);
    assert !runtime_util.values_equal(this.v1, this.v4);
    assert !runtime_util.values_equal(this.v4, this.v3);
  }
  private immutable_list<Object> make_list(final Object first, final Object second) {
    final base_list<Object> the_list = new base_list<Object>();
    the_list.append(first);
    the_list.append(second);
    return the_list.frozen_copy();
  }
  public void test_list_equals() {
    final immutable_list<Object> s1 = this.make_list(this.v1, this.v3);
    final immutable_list<Object> s2 = this.make_list(this.v2, this.v3);
    final immutable_list<Object> s3 = this.make_list(this.v4, this.v3);
    assert runtime_util.values_equal(s1, s2);
    assert !runtime_util.values_equal(s1, s3);
  }
  public void test_equals() {
    assert runtime_util.values_equal(new base_string("Hi"), new base_string("Hi"));
    assert !runtime_util.values_equal(new base_string("Hi"), new base_string("Hello"));
    assert runtime_util.values_equal(null, null);
    assert !runtime_util.values_equal(null, new base_string("foo"));
    assert !runtime_util.values_equal(new base_string("bar"), null);
  }
  public void test_escape() {
    assert runtime_util.values_equal(runtime_util.escape_markup(new base_string("foo")), new base_string("foo"));
    assert runtime_util.values_equal(runtime_util.escape_markup(new base_string("hello! <>&")), new base_string("hello! &lt;&gt;&amp;"));
    assert runtime_util.values_equal(runtime_util.escape_markup(new base_string("1: \' 2: \"")), new base_string("1: &apos; 2: &quot;"));
  }
  public void run_all_tests() {
    runtime_util.start_test(new base_string("test_runtime_util.test_class_name"));
    this.test_class_name();
    runtime_util.end_test();
    runtime_util.start_test(new base_string("test_runtime_util.test_hash_code"));
    this.test_hash_code();
    runtime_util.end_test();
    runtime_util.start_test(new base_string("test_runtime_util.test_simple_equals"));
    this.test_simple_equals();
    runtime_util.end_test();
    runtime_util.start_test(new base_string("test_runtime_util.test_list_equals"));
    this.test_list_equals();
    runtime_util.end_test();
    runtime_util.start_test(new base_string("test_runtime_util.test_equals"));
    this.test_equals();
    runtime_util.end_test();
    runtime_util.start_test(new base_string("test_runtime_util.test_escape"));
    this.test_escape();
    runtime_util.end_test();
  }
}
